{
  "project_name": "TMS - Transport Management System",
  "project_type": "web-app",
  "tech_stack": {
    "primary_language": "TypeScript/Python",
    "frameworks": ["React", "FastAPI", "Aiogram", "Vite"],
    "key_dependencies": [
      "PostgreSQL/PostGIS",
      "Redis",
      "OSRM (маршрутизация)",
      "Photon (геокодирование)",
      "Leaflet (карты)",
      "Zustand (state management)",
      "SQLAlchemy",
      "Alembic"
    ]
  },
  "target_audience": {
    "primary_persona": "Диспетчеры логистических компаний — специалисты, ответственные за планирование маршрутов, распределение заказов между водителями и контроль выполнения доставок в режиме реального времени",
    "secondary_personas": [
      "Водители — исполнители заказов, работающие через Telegram-бот",
      "Администраторы — управляющие системой, настройками и правами доступа",
      "Внешние подрядчики/партнёры — интеграция через API для создания заказов и получения статусов"
    ],
    "pain_points": [
      "Ручное планирование маршрутов занимает много времени",
      "Сложность контроля за большим парком водителей в реальном времени",
      "Риск назначения водителя на пересекающиеся по времени заказы",
      "Отсутствие единой системы для диспетчеров и водителей",
      "Высокая стоимость лицензий коммерческих TMS-решений",
      "Зависимость от западных вендоров и облачных сервисов"
    ],
    "goals": [
      "Автоматизировать распределение заказов между водителями",
      "Отслеживать местоположение всего парка на одной карте",
      "Минимизировать ошибки диспетчеров при планировании",
      "Получать актуальные статусы заказов в режиме реального времени",
      "Интегрировать систему с внешними партнёрами через API"
    ],
    "usage_context": "Система используется ежедневно в офисе логистической компании. Диспетчеры работают через веб-интерфейс на десктопе, водители — через Telegram-бот на смартфоне. Подрядчики интегрируются через REST API."
  },
  "product_vision": {
    "one_liner": "Комплексное open-source решение для управления логистикой и транспортом с интеграцией Telegram",
    "problem_statement": "Логистические компании тратят много времени на ручное планирование маршрутов, испытывают сложности с контролем парка в реальном времени и вынуждены платить высокие лицензионные сборы за коммерческие TMS-решения. TMS решает эти проблемы, предоставляя self-hosted платформу с автоматическим распределением заказов и отслеживанием водителей.",
    "value_proposition": "TMS — это готовый фундамент для цифровизации логистики без лицензионных платежей. Система объединяет диспетчеров, водителей и партнёров в единой экосистеме: веб-панель для планирования, Telegram-бот для водителей, API для интеграций. Всё это на собственных серверах компании.",
    "success_metrics": [
      "Сокращение времени на планирование маршрутов на 50%",
      "100% предотвращение конфликтов расписания водителей",
      "Снижение ошибок диспетчеров на 80%",
      "Время отклика интерфейса < 1 секунды",
      "Uptime системы > 99.5%"
    ]
  },
  "current_state": {
    "maturity": "mvp",
    "existing_features": [
      "Управление заказами (создание, редактирование, импорт из Excel)",
      "Визуальное планирование на Gantt-таймлайне с Drag-and-Drop",
      "Массовое распределение заказов (batch assignment)",
      "Защита от пересечения заказов по времени (PostgreSQL Exclusion Constraint)",
      "Карта в реальном времени с кластеризацией маркеров",
      "Telegram-бот для водителей (управление сменой, статусы заказов)",
      "Маршрутизация через OSRM с расчётом ETA",
      "Геокодирование через Photon",
      "API для подрядчиков с webhook-уведомлениями",
      "Авторизация через Telegram",
      "Система ролей (водитель, диспетчер, администратор)",
      "Тёмная тема и адаптивный дизайн",
      "PWA поддержка с offline режимом",
      "Мониторинг (Prometheus метрики, Sentry интеграция)"
    ],
    "known_gaps": [
      "Нет приложения для получателя (клиент не видит трек курьера)",
      "Нет задачи коммивояжёра (TSP/VRP) для оптимизации маршрутов",
      "Нет бухгалтерского учёта и интеграции с 1С",
      "Нет учёта ГСМ и планового ТО",
      "Нет реального расчёта рейтинга водителей",
      "Нет реального расчёта среднего времени ожидания"
    ],
    "technical_debt": [
      "TODO: Расчёт averageRating для водителей (src/api/routes.py)",
      "TODO: Расчёт averageWaitTime (src/api/routes.py)",
      "TODO: OrderService должен принимать дополнительные поля от contractors API",
      "Агент Ralph требует стабилизации и ограничения попыток"
    ]
  },
  "competitive_context": {
    "alternatives": [
      "Яндекс.Флот — крупный игрок с закрытой экосистемой",
      "MaxOptra — западное решение с высокой стоимостью",
      "GroozGo — российская TMS платформа",
      "Veeroute — оптимизация маршрутов",
      "Собственные Excel-таблицы и ручное планирование"
    ],
    "differentiators": [
      "Open-source: нет лицензионных платежей",
      "Self-hosted: данные остаются на серверах компании",
      "Telegram-интеграция: водители не устанавливают отдельное приложение",
      "Гибкость: возможность доработки под конкретные процессы",
      "Локальные гео-сервисы: OSRM и Photon без внешних API"
    ],
    "market_position": "Нишевое решение для средних логистических компаний, которые хотят контролировать свои данные, не платить за лицензии и иметь возможность доработки системы. Особенно актуально в условиях импортозамещения и ухода западных вендоров.",
    "competitor_pain_points": [],
    "competitor_analysis_available": false
  },
  "constraints": {
    "technical": [
      "Требуется PostgreSQL 14+ с расширением PostGIS",
      "Требуется Redis для кэширования геолокаций",
      "OSRM требует предобработки OSM-данных региона",
      "Photon требует увеличения vm.max_map_count",
      "Python 3.11+ для backend"
    ],
    "resources": [
      "Разработка ведётся преимущественно одним разработчиком",
      "Ограниченное время на тестирование новых фич"
    ],
    "dependencies": [
      "OSRM — маршрутизация (self-hosted)",
      "Photon — геокодирование (self-hosted)",
      "Telegram Bot API — коммуникация с водителями",
      "OpenStreetMap — данные для маршрутизации"
    ]
  },
  "created_at": "2025-01-22T12:00:00Z"
}
