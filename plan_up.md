# üöÄ Implementation Plan: –£–ª—É—á—à–µ–Ω–∏–µ Ralph –Ω–∞ –æ—Å–Ω–æ–≤–µ CrewAI

**–î–∞—Ç–∞:** 2026-01-19 (–æ–±–Ω–æ–≤–ª–µ–Ω–æ)  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –§–∞–∑—ã 1-4 —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã, —Ç—Ä–µ–±—É–µ—Ç—Å—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è  

---

## üìä –û–±—â–∏–π –ø—Ä–æ–≥—Ä–µ—Å—Å

| –§–∞–∑–∞ | –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –°—Ç–∞—Ç—É—Å | –§–∞–π–ª—ã |
|:-----|:----------|:-------|:------|
| **1** | Tool Registry | ‚úÖ **–ì–æ—Ç–æ–≤–æ** | `tools/base.py`, `registry.py`, `file_tools.py`, `exec_tools.py`, `search_tools.py` |
| **2** | Memory System | ‚úÖ **–ì–æ—Ç–æ–≤–æ** | `memory/memory_manager.py`, `short_term_memory.py`, `reranker.py` |
| **3** | Flow Manager (DAG) | ‚úÖ **–ì–æ—Ç–æ–≤–æ** | `flow/flow_manager.py`, `handoff_manager.py`, `dynamic_router.py`, `refinement_cycle.py` |
| **4** | Specialized Agents | ‚úÖ **–ì–æ—Ç–æ–≤–æ** | `agents/roles.py`, `prompts/researcher_prompt.md`, `tester_prompt.md`, `reviewer_prompt.md` |
| **5** | Learning System | ‚è≥ **–ß–∞—Å—Ç–∏—á–Ω–æ** | `memory/lessons_learned.md` (—Ñ–∞–π–ª –µ—Å—Ç—å, –º–æ–¥—É–ª—å `learning.py` –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç) |
| **6** | –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ ralph.py | üö® **–¢—Ä–µ–±—É–µ—Ç—Å—è** | `ralph.py` ‚Äî –µ—Å—Ç—å –æ—à–∏–±–∫–∞ `get_project_context` |

---

## ‚úÖ –§–∞–∑–∞ 1: Tool Registry ‚Äî **–í—ã–ø–æ–ª–Ω–µ–Ω–æ**

### –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:
- `tools/base.py` ‚Äî –ë–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å `Tool` —Å Pydantic –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π
- `tools/registry.py` ‚Äî `ToolRegistry` —Å –≥–ª–æ–±–∞–ª—å–Ω—ã–º —Ä–µ–µ—Å—Ç—Ä–æ–º
- `tools/file_tools.py` ‚Äî `ReadFileTool`, `WriteFileTool`, `ListDirTool`
- `tools/exec_tools.py` ‚Äî `ExecCommandTool`
- `tools/search_tools.py` ‚Äî `GrepSearchTool`, `FindFilesTool`

### –¢–µ—Å—Ç—ã: ‚úÖ 5/5 passed

---

## ‚úÖ –§–∞–∑–∞ 2: Memory System ‚Äî **–í—ã–ø–æ–ª–Ω–µ–Ω–æ + –ë–æ–Ω—É—Å (RAG)**

### –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:
- `memory/memory_manager.py` ‚Äî `LongTermMemory` (SQLite), `EntityMemory` (JSON-–≥—Ä–∞—Ñ), `MemoryManager` (—Ñ–∞—Å–∞–¥)
- `memory/short_term_memory.py` ‚Äî RAG c ChromaDB –∏ semantic chunking
- `memory/reranker.py` ‚Äî FlashRank –¥–ª—è –ø–µ—Ä–µ—Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

### –ë–æ–Ω—É—Å: Hybrid RAG
- **RRF (Reciprocal Rank Fusion)** –¥–ª—è –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è SQLite + ChromaDB —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- **Semantic Chunking** –¥–ª—è —Ä–∞–∑–±–∏–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
- –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö: `long_term.db` (36KB, –∞–∫—Ç–∏–≤–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)

### –¢–µ—Å—Ç—ã: ‚úÖ 8/8 passed

---

## ‚úÖ –§–∞–∑–∞ 3: Flow Manager (DAG) ‚Äî **–í—ã–ø–æ–ª–Ω–µ–Ω–æ + DAG Architecture**

### –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:
- `flow/flow_manager.py` ‚Äî –û—Å–Ω–æ–≤–Ω–æ–π FlowManager —Å –ø–∞—Ä—Å–∏–Ω–≥–æ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- `flow/task_stage.py` ‚Äî Enum —Å—Ç–∞–¥–∏–π –∑–∞–¥–∞—á–∏ (PENDING ‚Üí PLANNING ‚Üí RESEARCHING ‚Üí CODING ‚Üí TESTING ‚Üí REVIEWING ‚Üí DONE)
- `flow/handoff_manager.py` ‚Äî –ü–µ—Ä–µ–¥–∞—á–∞ "—ç—Å—Ç–∞—Ñ–µ—Ç—ã" –º–µ–∂–¥—É —Ä–æ–ª—è–º–∏
- `flow/dynamic_router.py` ‚Äî –ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è –ø–æ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ (TRIVIAL/NORMAL/CRITICAL)
- `flow/refinement_cycle.py` ‚Äî –¶–∏–∫–ª –¥–æ—Ä–∞–±–æ—Ç–∫–∏ –ø–æ—Å–ª–µ —Ä–µ–≤—å—é

### –¢–µ—Å—Ç—ã: ‚úÖ 9/9 passed

---

## ‚úÖ –§–∞–∑–∞ 4: Specialized Agents ‚Äî **–í—ã–ø–æ–ª–Ω–µ–Ω–æ**

### –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:
- `agents/roles.py` ‚Äî Enum —Ä–æ–ª–µ–π –∞–≥–µ–Ω—Ç–æ–≤
- `prompts/researcher_prompt.md`
- `prompts/tester_prompt.md`
- `prompts/reviewer_prompt.md`
- `prompts/worker_prompt.md`

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è:
–§—É–Ω–∫—Ü–∏—è `get_prompt_for_role()` –≤ `ralph.py` –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç –ø—Ä–æ–º–ø—Ç—ã –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–µ–∫—É—â–µ–π —Ä–æ–ª–∏.

---

## üö® –§–∞–∑–∞ 5: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è ‚Äî **–¢—Ä–µ–±—É–µ—Ç—Å—è –¥–æ—Ä–∞–±–æ—Ç–∫–∞**

### –ü—Ä–æ–±–ª–µ–º–∞:
–ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ `ralph.py` –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –æ—à–∏–±–∫–∞:
```
NameError: name 'get_project_context' is not defined
```

### –ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–µ–π—Å—Ç–≤–∏—è:
1. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏—é `get_project_context()` (–±—ã–ª–∞ —É–¥–∞–ª–µ–Ω–∞ –∏–ª–∏ –Ω–µ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–∞)
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ –∏–º–ø–æ—Ä—Ç—ã –º–æ–¥—É–ª–µ–π –ø–æ—Å–ª–µ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞

---

## ‚è≥ –§–∞–∑–∞ 6: Learning System ‚Äî **–ß–∞—Å—Ç–∏—á–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ**

### –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:
- ‚úÖ –ë–∞–∑–∞ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –µ—Å—Ç—å: `MemoryManager.remember()` —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —É—Å–ø–µ—Ö–∏/–Ω–µ—É–¥–∞—á–∏ –≤ SQLite
- ‚úÖ –§–∞–π–ª `memory/lessons_learned.md` –¥–ª—è —Ä—É—á–Ω—ã—Ö –≤—ã–≤–æ–¥–æ–≤
- ‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –º–æ–¥—É–ª—å `learning.py`

---

## ‚úÖ –ö—Ä–∏—Ç–µ—Ä–∏–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è

| –ö—Ä–∏—Ç–µ—Ä–∏–π | –°—Ç–∞—Ç—É—Å |
|:---------|:-------|
| Tool Registry —Ä–∞–±–æ—Ç–∞–µ—Ç —Å 5+ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏ | ‚úÖ 6 –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ |
| LongTermMemory —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –∏—Å—Ç–æ—Ä–∏—é –≤ SQLite | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç |
| EntityMemory —Å—Ç—Ä–æ–∏—Ç –≥—Ä–∞—Ñ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç |
| FlowManager —É–ø—Ä–∞–≤–ª—è–µ—Ç –ø–æ—Ä—è–¥–∫–æ–º –∑–∞–¥–∞—á | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç |
| DAG —Å Handoff –∏ Rollback | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç |
| Specialized Agents –ø–µ—Ä–µ–∫–ª—é—á–∞—é—Ç—Å—è | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç |
| LearningSystem –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –ø–æ–¥—Ö–æ–¥—ã | ‚è≥ –ß–∞—Å—Ç–∏—á–Ω–æ |
| **ralph.py –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫** | üö® **–ù–ï–¢** |

---

## üìã –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏ (–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç)

1. **üö® CRITICAL:** –ò—Å–ø—Ä–∞–≤–∏—Ç—å `get_project_context` –≤ `ralph.py`
2. **HIGH:** –°–æ–∑–¥–∞—Ç—å –º–æ–¥—É–ª—å `learning.py` –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤
3. **MEDIUM:** –î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å —Å—Ç–∞–¥–∏–π –∑–∞–¥–∞—á –≤ PRD.md
4. **LOW:** –î–æ–±–∞–≤–∏—Ç—å –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—é DAG (Mermaid –¥–∏–∞–≥—Ä–∞–º–º—ã)
