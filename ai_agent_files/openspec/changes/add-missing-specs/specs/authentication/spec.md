## ADDED Requirements

### Requirement: Telegram WebApp Authentication
Система SHALL обеспечивать аутентификацию водителей через Telegram WebApp.

#### Scenario: Успешный вход через Telegram
- **WHEN** водитель отправляет POST запрос на `/api/v1/auth/login` с init_data от Telegram
- **THEN** система валидирует init_data используя секретный ключ бота
- **AND** извлекается telegram_id пользователя
- **AND** возвращается JWT токен с информацией о водителе

#### Scenario: Автоматическая регистрация нового водителя
- **WHEN** водитель впервые входит через Telegram
- **THEN** система автоматически создает запись водителя с данными из Telegram
- **AND** возвращается JWT токен для дальнейшей работы

#### Scenario: Невалидные данные Telegram
- **WHEN** отправляется запрос с подделанным или истекшим init_data
- **THEN** возвращается ошибка 401 Unauthorized

### Requirement: JWT Token Management
Система SHALL использовать JWT токены для защиты API эндпоинтов.

#### Scenario: Использование токена для доступа
- **WHEN** запрос к защищенному эндпоинту содержит валидный JWT токен в заголовке Authorization
- **THEN** токен валидируется и извлекается информация о водителе
- **AND** запрос обрабатывается с контекстом текущего водителя

#### Scenario: Невалидный или истекший токен
- **WHEN** запрос содержит невалидный или истекший токен
- **THEN** возвращается ошибка 401 Unauthorized

### Requirement: Protected Routes
Система SHALL требовать аутентификацию для большинства API эндпоинтов.

#### Scenario: Доступ к защищенным эндпоинтам
- **WHEN** запрос к `/api/v1/orders`, `/api/v1/drivers` или другим защищенным эндпоинтам не содержит токена
- **THEN** возвращается ошибка 401 Unauthorized

#### Scenario: Публичные эндпоинты
- **WHEN** запрос к `/api/v1/geocoding/search` или `/health`
- **THEN** аутентификация не требуется
