# План тестирования и приемки проекта

Перед сдачей проекта заказчику необходимо провести комплексное тестирование всех компонентов.

## 1. Функциональное тестирование (API & Backend)

### Аутентификация и пользователи
- [ ] Регистрация нового водителя (успешный кейс).
- [ ] Регистрация водителя с уже существующим телефоном (ошибка 409).
- [ ] Вход в систему (если реализован логин).

### Заказы (Orders)
- [ ] Создание заказа с валидными данными.
- [ ] **Конфликт времени**: Попытка создать заказ на время, занятое другим заказом у того же водителя (должна быть ошибка времени/пересечения).
- [ ] Перенос заказа (Move) на свободное время.
- [ ] Перенос заказа на занятое время (ошибка).
- [ ] Получение списка заказов (фильтрация по датам).

### Гео-сервисы
- [ ] Отправка координат водителя (`POST /drivers/{id}/location`) - проверить, что возвращает 204.
- [ ] Получение живых координат (`GET /drivers/live`) - проверить, что данные водителя появились в списке.
- [ ] Проверка расчета маршрута (обращение бэкенда к OSRM).

## 2. Интерфейс (Frontend)

### Карта
- [ ] Отображение маркеров водителей.
- [ ] Обновление позиций в реальном времени (не должно быть мерцания).
- [ ] Клик по маркеру открывает информацию о водителе.

### Расписание (Timeline)
- [ ] Отображение заказов на временной шкале.
- [ ] Drag-and-Drop заказа: успешное сохранение нового времени.
- [ ] Drag-and-Drop на занятый слот: возврат на старое место + уведомление об ошибке.

### Адаптивность
- [ ] Проверка отображения на десктопе (Chrome, Firefox).
- [ ] Проверка мобильной версии (если предусмотрена).

## 3. Нагрузочное и стресс-тестирование

- [ ] **WebSocket/Polling**: Подключить 10-50 клиентов одновременно, проверить нагрузку на CPU бэкенда.
- [ ] **High-load ingestion**: Эмуляция отправки координат от 100 водителей раз в 5 секунд. Проверить рост очереди Redis и работу воркера.

## 4. Инфраструктура и отказоустойчивость

- [ ] **Restart DB**: Перезапустить контейнер Postgres. Проверить, что бэкенд переподключился автоматически.
- [ ] **Restart Redis**: Перезапустить Redis. Проверить, что гео-данные не потерялись (если настроен persistence) или система восстановилась.
- [ ] **Cold Start**: Полная остановка и чистый старт (`docker-compose down && docker-compose up`). Проверить, что все поднялось (особенно OSRM/Photon, которые долго грузятся).

## 5. Безопасность

- [ ] Убедиться, что debug режим выключен (`DEBUG=False`) в проде.
- [ ] Проверить, что порты БД и Redis не торчат наружу (в `docker-compose.yml` порты должны быть закрыты или привязаны к 127.0.0.1, если доступ нужен только внутри сети машин).
- [ ] Проверить CORS настройки (не должно быть `allow_origins=["*"]` в проде).
