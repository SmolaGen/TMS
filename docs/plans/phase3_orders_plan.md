# План реализации: Фаза 3 — Улучшенное управление заказами

Этот план описывает внедрение полноценного функционала управления заказами, включая табличное представление, фильтрацию и улучшенный таймлайн.

**Статус:** Ожидает подтверждения
**Приоритет:** Высокий

## 1. Компоненты (Frontend)

### 1.1. Новые компоненты
*   **`OrderFilters.tsx`**: Панель фильтров (поиск, мульти-селект статусов, выбор водителей, диапазон дат). Позволит диспетчеру быстро находить нужные заказы.
*   **`ViewToggle.tsx`**: Переключатель режимов отображения:
    *   `map-timeline`: Карта сверху, таймлайн снизу (логистический фокус).
    *   `table-map`: Таблица слева/сверху, карта справа (операционный фокус).
    *   `table-only`: Только таблица (аналитический фокус).
*   **`OrdersTable.tsx`**: Компонент на базе `antd Table`. Включает:
    *   Сортировку по ID, статусу, времени.
    *   Кастомные рендеры для адресов и статусов.
    *   Действия (Назначить, Отменить, Редактировать).

### 1.2. Обновление существующих компонентов
*   **`TimelineView.tsx`**:
    *   Добавление цветовой кодировки элементов в зависимости от статуса заказа (`pending`, `in_progress`, `completed` и т.д.).
    *   Поддержка Zoom (через Ctrl + колесо мыши).
    *   Snap (привязка) к 15-минутным интервалам при перемещении.

## 2. Стилизация (CSS)
*   Добавление классов в `App.css` для:
    *   Статусов таймлайна (разные фоны и границы).
    *   Подсветки строк в таблице (например, заказы без назначенного водителя).

## 3. Страницы
*   **`OrdersPage.tsx`**: Полная переработка текущей заглушки.
    *   Интеграция фильтров в состояние страницы.
    *   Внедрение логики переключения видов.
    *   Синхронизация выбранного заказа между таблицей, картой и таймлайном.

## 4. План работ (Workflow)
1.  **Подготовка стилей**: Добавить CSS правила в `App.css`.
2.  **Создание `ViewToggle`**: Простой компонент для переключения режимов.
3.  **Создание `OrderFilters`**: Реализация панели фильтров.
4.  **Создание `OrdersTable`**: Таблица с базовым функционалом.
5.  **Обновление `TimelineView`**: Внедрение стилей и улучшений взаимодействия.
6.  **Сборка `OrdersPage`**: Объединение всех частей в единый интерфейс.
7.  **Верификация**: Сборка проекта (`npm run build`) и проверка типов (`tsc`).

## 5. Вопросы к пользователю
1.  **Массовые действия**: Нужна ли возможность выбрать несколько заказов в таблице для пакетного назначения водителя или отмены?
2.  **Экспорт**: Требуется ли кнопка выгрузки текущего списка в Excel/CSV?
3.  **Группировка**: Стоит ли в таймлайне выносить заказы без водителя в отдельную виртуальную группу сверху?

---
*После подтверждения плана я приступлю к реализации первого этапа (стили и компоненты).*
