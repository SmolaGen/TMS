# frontend-dashboard Specification

## Purpose
TBD - created by archiving change add-missing-specs. Update Purpose after archive.
## Requirements
### Requirement: Live Map Display
Система SHALL отображать карту с позициями водителей и маршрутами заказов в реальном времени.

#### Scenario: Отображение карты с водителями
- **WHEN** пользователь открывает Dashboard
- **THEN** отображается интерактивная карта (Leaflet) с центром на Владивостоке
- **AND** на карте отображаются маркеры всех активных водителей с их текущими координатами
- **AND** координаты обновляются в реальном времени через WebSocket

#### Scenario: Отображение маршрутов заказов
- **WHEN** на карте отображаются заказы
- **THEN** маршруты заказов отрисовываются как линии между pickup и dropoff точками
- **AND** выбранный заказ выделяется визуально

#### Scenario: Выбор водителя на карте
- **WHEN** пользователь кликает на маркер водителя
- **THEN** вызывается callback onDriverSelect с ID водителя

### Requirement: Timeline View
Система SHALL отображать заказы в виде временной шкалы (Gantt chart).

#### Scenario: Отображение заказов на таймлайне
- **WHEN** пользователь открывает Dashboard
- **THEN** в нижней части экрана отображается Timeline View (vis-timeline)
- **AND** заказы отображаются как временные интервалы, сгруппированные по водителям
- **AND** каждый заказ показывает время начала и окончания

#### Scenario: Drag-and-Drop перемещение заказов
- **WHEN** пользователь перетаскивает заказ на таймлайне
- **THEN** время заказа обновляется через API (PATCH /orders/{id}/move)
- **AND** применяется Optimistic UI (обновление без ожидания ответа)
- **AND** при ошибке изменения откатываются

#### Scenario: Выбор заказа на таймлайне
- **WHEN** пользователь кликает на заказ на таймлайне
- **THEN** открывается OrderDetailDrawer с детальной информацией о заказе

### Requirement: Order Creation Modal
Система SHALL предоставлять модальное окно для создания новых заказов.

#### Scenario: Открытие модального окна создания
- **WHEN** пользователь кликает кнопку "Новый заказ"
- **THEN** открывается CreateOrderModal с формой для ввода данных заказа
- **AND** форма включает поля: pickup/dropoff адреса, время, приоритет, комментарий

#### Scenario: Поиск адресов в форме
- **WHEN** пользователь вводит адрес в поле AddressPicker
- **THEN** система выполняет поиск через API геокодинга
- **AND** отображается список предложений адресов
- **AND** при выборе адреса заполняются координаты

#### Scenario: Успешное создание заказа
- **WHEN** пользователь заполняет форму и нажимает "Создать"
- **THEN** отправляется POST запрос на `/api/v1/orders`
- **AND** модальное окно закрывается
- **AND** заказ появляется на карте и таймлайне

### Requirement: Order Detail Drawer
Система SHALL отображать детальную информацию о заказе в боковой панели.

#### Scenario: Открытие деталей заказа
- **WHEN** пользователь выбирает заказ на карте или таймлайне
- **THEN** открывается OrderDetailDrawer с полной информацией о заказе
- **AND** отображаются: статус, водитель, адреса, время, маршрут, комментарий

#### Scenario: Закрытие панели
- **WHEN** пользователь кликает кнопку закрытия или вне панели
- **THEN** OrderDetailDrawer закрывается

### Requirement: WebSocket Connection Status
Система SHALL отображать статус подключения WebSocket.

#### Scenario: Индикатор подключения
- **WHEN** пользователь открывает Dashboard
- **THEN** в верхнем левом углу отображается Badge со статусом подключения
- **AND** статус "Online" при активном соединении, "Подключение..." при отсутствии

### Requirement: Responsive Layout
Система SHALL использовать адаптивный layout с разделением экрана.

#### Scenario: Разделение экрана
- **WHEN** пользователь открывает Dashboard
- **THEN** карта занимает 60% высоты экрана
- **AND** таймлайн занимает 40% высоты экрана
- **AND** оба компонента обновляются синхронно

