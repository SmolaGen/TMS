## ADDED Requirements

### Requirement: Route Calculation
Система SHALL рассчитывать маршруты между точками через OSRM.

#### Scenario: Расчет маршрута при создании заказа
- **WHEN** создается заказ с координатами pickup и dropoff
- **THEN** система обращается к OSRM API для расчета маршрута
- **AND** сохраняются distance_meters (дистанция в метрах)
- **AND** сохраняются duration_seconds (время в пути в секундах)
- **AND** сохраняется route_geometry (закодированная геометрия маршрута в формате polyline)

#### Scenario: Ошибка расчета маршрута
- **WHEN** OSRM не может рассчитать маршрут (например, нет пути)
- **THEN** заказ все равно создается, но distance_meters и duration_seconds остаются null

### Requirement: ETA Calculation
Система SHALL рассчитывать Estimated Time of Arrival на основе маршрута.

#### Scenario: Использование ETA для планирования
- **WHEN** рассчитывается маршрут
- **THEN** ETA используется для проверки возможности выполнения заказа в указанное время
- **AND** учитывается при проверке конфликтов времени

### Requirement: Route Geometry Storage
Система SHALL хранить геометрию маршрута для отображения на карте.

#### Scenario: Сохранение геометрии маршрута
- **WHEN** маршрут рассчитывается через OSRM
- **THEN** геометрия маршрута кодируется в polyline и сохраняется в route_geometry
- **AND** геометрия может быть декодирована для отображения на фронтенде

### Requirement: OSRM Service Integration
Система SHALL использовать локальный инстанс OSRM для независимости от внешних API.

#### Scenario: Работа с локальным OSRM
- **WHEN** система рассчитывает маршруты
- **THEN** запросы направляются на локальный OSRM (порт 5000)
- **AND** используются данные региона, подготовленные заранее
